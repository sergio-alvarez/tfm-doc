=== Análisis del sistema

==== Definición y alcance del Sistema

A partir de las tecnologías y experimentos desarrollados en las secciones anteriores, las próximas páginas recogen el análisis y diseño de una posible aplicación web que, basándose en los trabajos anteriores, sirva para ofrecer un servicio de geolocalización de tuits en base a su contenido.

El sistema deberá ser capaz de permitir a los usuarios la creación de *proyectos* en los que identificar sobre qué idioma, localización y términos desean realizar la monitorización. Y ofrecer una interfaz web sencilla en la que puedan consultar los resultados y recuperar la información para poder trabajar posteriormente con ella (es decir, se debe brindar la capacidad de descargar los datos en algún tipo de fichero con información estructurada como CSV, JSON o XML).

El _back-end_ de la aplicación deberá utilizar la experiencia de los experimentos anteriores para poder repetir los resultados obtenidos. Por tanto, deberá ser capaz de recuperar tuits de manera ininterrumpida a partir de algún streaming de datos con el objetivo de tener constantemente la información necesaria para poder ejecutar los proyectos de los usuarios. Además, debe ser capaz de comunicarse con software de aprendizaje automático y crear (o reutilizar) modelos de clasificación _al vuelo_ para cada uno de los proyectos generados.

==== Requisitos del Sistema

===== Requisitos Funcionales

.Requisitos de Usuario - R1.x
[cols="1,2,3" options="header", id="user-requirements"]
|===
|Código
|Nombre del Requisito
|Descripción del Requisito

|R1.1
|Crear cuenta en el Sistema
|El usuario debe ser capaz de crear una cuenta en el sistema mediante la inserción de información básica como: *e-mail*, *nombre* y *contraseña* a través de un formulario de registro disponible en la aplicación web.

|R1.2
|Identificarse
|Todo aquel usuario con una cuenta creada en el sistema, deberá ser capaz de identificarse a través de un formulario de _login_ accesible desde la aplicación web.

|R1.3
|Crear proyecto
|El usuario debe ser capaz de crear un proyecto sobre el que obtener datos geolocalizados aportando de manera sencilla toda la información necesaria para su evaluación: idioma, palabras a monitorizar, área local y global y fecha de evaluación.

|R1.4
|Selección de _bounding boxes_ de manera gráfica
|El usuario debe ser capaz de seleccionar _bounding boxes_ de manera gráfica a través de un mapa.

|R1.5
|Evaluar un proyecto
|El usuario debe ser capaz de evaluar un proyecto para las fechas seleccionadas en el momento de su creación.

|R1.6
|Descargar resultados de ejecución
|El usuario debe disponer de un mecanismo para descargar los datos de cada ejecución en, al menos, formato XML y JSON.

|R1.7
|Acceso a histórico de proyectos
|El usuario debe tener acceso a su historial de proyectos a través de la aplicación web. Deberá ser capaz de reevaluar un proyecto anterior o consultar su información.

|R1.8
|Cerrar sesión
|El usuario deberá poder cerrar su sesión en la aplicación de manera sencilla a través de la interfaz web.
|===

.Requisitos a nivel de Proyecto - R2.x
[cols="1,2,3" options="header", id="project-requirements"]
|===
|Código
|Nombre del Requisito
|Descripción del Requisito

|R2.1
|Fechas de ejecución
|Los proyectos deben tener asignada una fecha sobre la que se desea realizar la ejecución. Esta fecha siempre tiene que ser igual o posterior al día de creación del proyecto (en función de si se quiere trabajar con datos ya almacenados en el sistema o con datos futuros respectivamente).

|R2.2
|Múltiples idiomas
|Los proyectos deben poder trabajar con múltiples idiomas. Cómo mínimo se debe ofrecer la posibilidad de trabajar con *inglés* y *español*.

|R2.3
|Términos a monitorizar personalizables
|Los proyectos deben poder trabajar sobre una lista de términos propuesta por el usuario y encontrar y geolocalizar aquellos tuits que los contengan. Estos términos se deberán añadir en el momento de la creación del proyecto y deberán cumplir unas condiciones concretas: se debe incluir una fila por cada término que se desee monitorizar.

|R2.4
|Localización local
|Los proyectos deben ser capaces de trabajar sobre un área local de la que obtener tuits.

|R2.5
|Localización global
|De manera análoga al requisito de localización local, los proyectos debe ser capaces también de trabajar con otras áreas en los que se puedan encontrar tuits escritos en el mismo idioma seleccionado. De esta manera se aportará al sistema de los mecanismos adecuados para poder buscar términos discriminativos.

|R2.6
|Reevaluar un proyecto
|El sistema debe ofrecer la posibilidad de reevaluar un proyecto a partir de una nueva fecha de ejecución que cumpla las mismas condiciones que las establecidas en el momento de su creación (se debe seleccionar una fecha igual o posterior a la del momento de la reevaluación).
|===

.Requisitos a nivel de Ejecución - R3.x
[cols="1,2,3" options="header", id="execution-requirements"]
|===
|Código
|Nombre del Requisito
|Descripción del Requisito

|R3.1
|Exhaustividad variable
|Las ejecuciones deben poder trabajar con diferentes niveles de exhaustividad con el objetivo de procesar más o menos tuits a distintos niveles de confianza.

|R3.2
|Exportar resultados
|Los resultados de una ejecución deben poder ser exportados a *XML* y *JSON*.
|===

===== Requisitos No Funcionales

.Requisitos de acceso a la información - RNF1.x
[cols="1,2,3" options="header", id="information-retrival-requirements"]
|===
|Código
|Nombre del Requisito
|Descripción del Requisito

|RNF1.1
|Recolección de datos de manera ininterrumpida
|El sistema deberá de crear un flujo de comunicación constante que abastezca de información ininterrumpidamente.

|RNF1.2
|Recolección de datos parametrizable
|Se deberá de trabajar con un sistema de _streaming_ de datos que acepte parámetros para devolver información de manera selectiva.

|RNF1.3
|Utilización de un sistema de _streaming_ que aporte más de un 1% de los datos disponibles
|Con el objetivo de poder ofrecer el mejor servicio posible, será necesario trabajar con un sistema de _streaming_ que sea capaz ofrecer el mayor número de datos posibles, es decir, que no limite como en el caso de la API Streaming de Twitter, su flujo a únicamente un 1% del total del _streaming_ público.
|===

.Requisitos de Seguridad - RNF2.x
[cols="1,2,3" options="header", id="security-requirements"]
|===
|Código
|Nombre del Requisito
|Descripción del Requisito

|RNF2.1
|SSL
|La aplicación deberá funcionar sobre *HTTPS* y *SSL* mediante un certificado válido que asegure que la información no pueda ser interceptada por terceras partes.

|RNF2.2
|Hashing para las contraseñas de usuario
|Las contraseñas de los usuarios deberán ser _hasheadas_ mediante el algoritmo *bcrypt*.
|===

.Requisitos Tecnológicos - RNF3.x
[cols="1,2,3" options="header", id="technologies-requirements"]
|===
|Código
|Nombre del Requisito
|Descripción del Requisito

|RNF3.1
|Scala
|Se utilizará el lenguaje de programación *Scala* con el objetivo de aprovechar la experiencia previa de la etapa de experimentación y prototipado. Su soporte para programación funcional dará al sistema la flexibilidad necesaria en materia de escalabilidad y concurrencia de cara al futuro.

|RNF3.2
|Play! Framework
|Play! será el framework web utilizado para desarrollar la aplicación. Su soporte nativo para Scala, desarrollo de trabajos asíncronos e imposición de la arquitectura *Modelo-Vista-Controlador* encaja a la perfección con los requisitos del sistema.

|RNF3.3
|Vowpal Wabbit
|Vowpal Wabbit y su ejecución como _daemon_ del sistema, velocidad y buenos resultados en la etapa de prototipado, será el software de aprendizaje automático utilizado.

|RNF3.4
|Mercurial
|Se utilizará Mercurial como sistema de control de versiones distribuido apoyado sobre *Bitbucket* como hosting del proyecto. Mercurial es un SCVD similar a Git, pero que simplifica varias de las acciones habituales en el flujo de trabajo de un desarrollador: `pull`, `push`, `merge`, etc. A pesar de no tener un sistema de ramas tan potente como Git, permite un funcionamiento _similar_ mediante el uso de *bookmarks*.
|===

.Requisitos de Almacenamiento - RNF4.x
[cols="1,2,3" options="header", id="storage-requirements"]
|===
|Código
|Nombre del Requisito
|Descripción del Requisito

|RNF4.1
|48h de tuits.
|Debido a que los experimentos realizados han funcionado bien con datos recogidos en periodos de 24 horas, se almacenarán datos únicamente sobre periodos de 48h. eliminando todos aquellos más antiguos con el objetivo de minimizar el tamaño de disco utilizado.

|RNF4.2
|Máximo número de tuits por ejecución.
|Para prevenir un abuso de la capacidad de disco, que podría llegar a almacenar ficheros de cientos de megabytes en resultados, es necesario limitar el número máximo de tuits que se podrán guardar por ejecución para generar los ficheros XML y JSON. Este valor se deberá calcular de manera experimental, pero el fichero de resultados no debería ser superior a *~200MB*.
|===

==== Análisis de casos de uso y escenarios

.Casos de Uso para la Gestión de Usuarios
image::application/use-cases/user-managements.png[align="center"]

.CU Usuario - Gestión Usuarios 1.1 Crear cuenta en el sistema
[cols="1s,3", id="cu-user-system-1-1"]
|===
|Precondiciones
|El usuario se encuentra en la página principal de la aplicación y no dispone de una cuenta de usuario en el sistema.

|Postcondiciones
|El usuario habrá completado satisfactoriamente el proceso de creación de cuenta y podrá hacer _login_ en el sistema de manera satisfactoria.

|Actores
|Un usuario.

|Descripción
|Situándose en la pantalla de inicio de la aplicación, el usuario accederá al formulario de creación de cuenta mediante un enlace o cualquier otro componente de la interfaz de usuario que alerte gráficamente de que se puede crear una nueva cuenta de usuario. Una vez en el formulario, se pedirán datos básicos como: *e-mail*, *nombre* y *contraseña* (con su correspondiente confirmación). Al rellenar el formulario, el sistema deberá procesar la petición y notificar al usuario de que su cuenta se ha creado con éxito.

|Variaciones
|Si el usuario introduce valores incorrectos en algunos de los campos, el sistema deberá aportar un mecanismo que alerte del error y vuelva a mostrar el formulario de registro.

|Excepciones
| -

|Notas
| -

|Requisitos contemplados
|R1.1
|===

.CU Usuario - Gestión Usuarios 1.2 Identificarse en el sistema
[cols="1s,3", id="cu-user-system-1-2"]
|===
|Precondiciones
|El usuario debe tener una cuenta ya creada en el sistema, no debe estar identificado y debe estar situado en la página de inicio de la aplicación.

|Postcondiciones
|El usuario habrá podido identificarse satisfactoriamente y acceder a su *dashboard* de proyectos y evaluaciones.

|Actores
|Un usuario.

|Descripción
|Desde la pantalla principal de la aplicación, el usuario podrá acceder al formulario de identificación mediante un enlace o elemento identificativo a nivel gráfico en la interfaz web. La página de identificación constará de un pequeño formulario donde el usuario pueda insertar su *e-mail* y *contraseña*. Una vez identificado correctamente, el sistema redireccionará al usuario a su *dashboard* de proyectos y ejecuciones.

|Variaciones
|En caso de que las credenciales introducidas por el usuario sean incorrectas, el sistema mostrará sobre el mismo formulario de identificación que existe un problema con las credenciales indicando que no son válidas.

|Excepciones
| -

|Notas
| -

|Requisitos contemplados
|R1.2
|===

.CU Usuario - Gestión Usuarios 1.3 Cerrar sesión en el sistema
[cols="1s,3", id="cu-user-system-1-3"]
|===
|Precondiciones
|El usuario se encuentra identificado en el sistema.

|Postcondiciones
|El usuario habrá conseguido cerrar su sesión actual en el sistema y estará situado en la página de inicio.

|Actores
|Un usuario.

|Descripción
|Estando el usuario identificado en el sistema, y siendo la acción accesible desde cualquier punto de la aplicación a través de un menú superior o elemento gráfico permanente, se podrá seleccionar _Cerrar sesión_ sobre la sesión actual del usuario.

|Variaciones
| -

|Excepciones
|En caso de no poder completar la acción, se deberá notificar al usuario de que ha existido un error a la hora de cerrar su sesión actual.

|Notas
| -

|Requisitos contemplados
|R1.8
|===

.Casos de Uso para la Gestión de Proyectos
image::application/use-cases/projects-management.png[align="center"]

.CU Usuario - Gestión de Proyectos 2.1 Crear Proyecto
[cols="1s,3", id="cu-user-project-2-1"]
|===
|Precondiciones
|El usuario se encuentra identificado y situado en su *dashboard* de proyectos y ejecuciones.

|Postcondiciones
|El usuario tendrá un nuevo proyecto creado en su cuenta.

|Actores
|Un usuario.

|Descripción
|Desde la pantalla de dashboard, el usuario podrá acceder a la creación de un nuevo proyecto mediante un elemento gráfico visible en la interfaz web que lo conducirá a un formulario de creación. En este formulario se deberá completar información básica como: *nombre*, *fecha*, *área local y global*, *términos a monitorizar* e *idioma* para el nuevo proyecto.

|Variaciones
|En caso de introducir valores incorrectos en el formulario de creación, el sistema deberá notificar sobre el mismo formulario qué errores existen y que no se ha podido completar el proceso de creación.

|Excepciones
| -

|Notas
| -

|Requisitos contemplados
|R1.3
|===

.CU Usuario - Gestión de Proyectos 2.1.1 Seleccionar idioma
[cols="1s,3", id="cu-user-project-2-1-1"]
|===
|Precondiciones
|El usuario se encuentra en el formulario de creación de proyecto.

|Postcondiciones
|El usuario habrá seleccionado el idioma del proyecto satisfactoriamente.

|Actores
|Un usuario.

|Descripción
|En el momento de la creación del proyecto, se deberá mostrar un componente visual que permita al usuario seleccionar el idioma del proyecto a partir de una lista de opciones predefinidas. Como mínimo, se deberán mostrar las opciones de *inglés* y *español*.

|Variaciones
| -

|Excepciones
| -

|Notas
| -

|Requisitos contemplados
|R2.2
|===

.CU Usuario - Gestión de Proyectos 2.1.2 Añadir términos a monitorizar
[cols="1s,3", id="cu-user-project-2-1-2"]
|===
|Precondiciones
|El usuario se encuentra en el formulario de creación de proyecto.

|Postcondiciones
|El usuario habrá seleccionado una lista de términos a monitorizar.

|Actores
|Un usuario.

|Descripción
|El usuario dispone de un campo en el formulario de creación de proyectos en el que puede seleccionar un fichero de su disco duro para introducir las palabras o términos que desea monitorizar.

|Variaciones
| -

|Excepciones
| -

|Notas
|Preferiblemente, se debería realizar un análisis del fichero en el momento en que el usuario realiza la subida del mismo para asegurar que cumpla con el formato establecido. En caso de no hacerlo, habría que realizar la notificación en el punto de ejecución del proyecto.

|Requisitos contemplados
|R2.3
|===

.CU Usuario - Gestión de Proyectos 2.1.3 Seleccionar área local
[cols="1s,3", id="cu-user-project-2-1-3"]
|===
|Precondiciones
|El usuario se encuentra en el formulario de creación de proyecto.

|Postcondiciones
|El usuario habrá seleccionado la localización local sobre la que desea realizar la ejecución.

|Actores
|Un usuario.

|Descripción
|En el formulario de creación de un nuevo proyecto, el usuario podrá seleccionar de manera gráfica a través de un mapa, las localizaciones sobre las que desea realizar la monitorización.

|Variaciones
| -

|Excepciones
| -

|Notas
| -

|Requisitos contemplados
|R1.4; R2.4
|===

.CU Usuario - Gestión de Proyectos 2.1.4 Seleccionar área global
[cols="1s,3", id="cu-user-project-2-1-4"]
|===
|Precondiciones
|El usuario se encuentra en el formulario de creación de proyecto.

|Postcondiciones
|El usuario habrá seleccionado las localizaciones globales que ayudarán a identificar términos del área local.

|Actores
|Un usuario.

|Descripción
|En el formulario de creación de un nuevo proyecto, el usuario podrá seleccionar de manera gráfica a través de un mapa, las localizaciones globales que ayudarán a reforzar el conocimiento sobre las áreas locales.

|Variaciones
| -

|Excepciones
| -

|Notas
|Aunque no exista ninguna restricción a la hora de señalar las localizaciones globales, se debería indicar al usuario que las localizaciones globales deben ser territorios donde se hable el mismo idioma que en los territorios seleccionados para el área local.

|Requisitos contemplados
|R1.4; R2.5
|===

.CU Usuario - Gestión de Proyectos 2.1.5 Establecer fecha de ejecución
[cols="1s,3", id="cu-user-project-2-1-5"]
|===
|Precondiciones
|El usuario se encuentra en el formulario de creación de proyecto.

|Postcondiciones
|El usuario habrá establecido una fecha para la ejecución del proyecto.

|Actores
|Un usuario.

|Descripción
|En el formulario de creación de un nuevo proyecto el usuario deberá seleccionar, a través de un componente diseñado para tal fin (un calendario o similar), la fecha para realizar la ejecución del proyecto.

|Variaciones
| -

|Excepciones
| -

|Notas
|Se deberá utilizar algún mecanismo que indique al usuario que no debe seleccionar fechas anteriores al momento actual en el que realiza la creación (por ejemplo, deshabilitando los días anteriores, en caso de tratarse de un componente de tipo Calendario).

|Requisitos contemplados
|R1.5; R2.1; R.6
|===

.CU Usuario - Gestión de Proyectos 2.2 Acceder al histórico de proyectos
[cols="1s,3", id="cu-user-project-2-2"]
|===
|Precondiciones
|El usuario está indentificado correctamente en el sistema.

|Postcondiciones
|El usuario es capaz de visualizar el histórico de proyectos.

|Actores
|Un usuario.

|Descripción
|Desde la página del *dashboard* principal del usuario se debe poder acceder a una sección de *Proyectos* donde se recojan todos los proyectos realizados por el usuario así como una breve descripción de sus características.

|Variaciones
| -

|Excepciones
| -

|Notas
| -

|Requisitos contemplados
|R1.7
|===

.CU Usuario - Gestión de Proyectos 2.2.1 Consultar proyecto anterior
[cols="1s,3", id="cu-user-project-2-2-1"]
|===
|Precondiciones
|El usuario está visualizando el histórico de Proyectos.

|Postcondiciones
|El usuario está visualizando la vista en detalle de un proyecto anterior.

|Actores
|Un usuario.

|Descripción
|El usuario debe tener un enlace en la página del histórico de proyectos que le permita consultar los detalles del Proyecto así como realizar alguna modificación o reevaluación.

|Variaciones
| -

|Excepciones
| -

|Notas
| -

|Requisitos contemplados
|R1.7; R2.6
|===

.Casos de Uso para la Gestión de Ejecuciones
image::application/use-cases/execution-management.png[align="center"]

.CU Usuario - Gestión de Ejecuciones 3.1 Evaluar proyecto
[cols="1s,3", id="cu-user-project-3-1"]
|===
|Precondiciones
|El usuario se encuentra en la vista detallada de un proyecto.

|Postcondiciones
|El usuario habrá realizado una ejecución con éxito.

|Actores
|Un usuario.

|Descripción
|El usuario deberá poder ejecutar un proyecto para las fechas indicadas en el momento de su creación. Para ello, se deberá de indicar de manera gráfica cuando una ejecución es posible y los dos mecanismos para empezar y detener dicha ejecución.

|Variaciones
|Será posible también iniciar la ejecución de un proyecto directamente desde el *dashboard* de proyectos mediante un enlace en la zona del resumen de características.

|Excepciones
| -

|Notas
|Preferiblemente, la ejecución de un proyecto se deberá realizar en una vista independiente de la vista detallada del proyecto donde se origine.

|Requisitos contemplados
|R1.5
|===

.CU Usuario - Gestión de Ejecuciones 3.2 Consultar resultados de ejecución
[cols="1s,3", id="cu-user-project-3-2"]
|===
|Precondiciones
|El usuario ha realizado una ejecución de manera satisfactoria y se encuentra en el *dashboard* de ejecuciones.

|Postcondiciones
|El usuario ha podido descargar satisfactoriamente los resultados de la ejecución.

|Actores
|Un usuario.

|Descripción
|Desde el conjunto de ejecuciones realizadas, se deberá poder acceder a sus resultados obtenidos mediante un enlace para descargar el fichero de resultados en formato *XML* o *JSON*.

|Variaciones
| -

|Excepciones
| -

|Notas
| -

|Requisitos contemplados
|R1.6; R3.2
|===

.CU Usuario - Gestión de Ejecuciones 3.3 Reevaluar proyecto
[cols="1s,3", id="cu-user-project-3-3"]
|===
|Precondiciones
|El usuario se debe de encontrar en la vista del histórico de proyectos.

|Postcondiciones
|El usuario habrá sido capaz de reevaluar un proyecto.

|Actores
|Un usuario.

|Descripción
|Para reevaluar un proyecto que ya ha sido evaluado anteriormente, será necesario modificar su fecha de evaluación para la nueva fecha sobre la que se desea realizar. En ese momento el sistema volverá a recopilar los datos necesarios para poder realizar una reevaluación. En cuanto los datos estén disponibles, se deberá seguir el mismo escenar presentado para <<cu-user-project-3-1>>

|Variaciones
| -

|Excepciones
| -

|Notas
| -

|Requisitos contemplados
|R2.6
|===

==== Diseño de _mockups_ para interfaces de usuario

.Pantalla de login de la aplicación.
image::application/mockup/home.png[align="center"]

.Pantalla que muestra el dashboard del usuario en la sección de proyectos
image::application/mockup/dashboard-projects.png[align="center"]

.Pantalla que muestra el dashboard del usuario en la sección de ejecuciones
image::application/mockup/dashboard-executions.png[align="center"]

.Lightboxes de creación de un nuevo proyecto
image::application/mockup/new-project.png[height="650px",align="center"]

.Pantalla de ejecución de un proyecto en tiempo real
image::application/mockup/execution.png[align="center"]
